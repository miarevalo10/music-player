(function(e){function t(t){for(var n,i,l=t[0],a=t[1],c=t[2],d=0,p=[];d<l.length;d++)i=l[d],Object.prototype.hasOwnProperty.call(r,i)&&r[i]&&p.push(r[i][0]),r[i]=0;for(n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n]);u&&u(t);while(p.length)p.shift()();return s.push.apply(s,c||[]),o()}function o(){for(var e,t=0;t<s.length;t++){for(var o=s[t],n=!0,l=1;l<o.length;l++){var a=o[l];0!==r[a]&&(n=!1)}n&&(s.splice(t--,1),e=i(i.s=o[0]))}return e}var n={},r={app:0},s=[];function i(t){if(n[t])return n[t].exports;var o=n[t]={i:t,l:!1,exports:{}};return e[t].call(o.exports,o,o.exports,i),o.l=!0,o.exports}i.m=e,i.c=n,i.d=function(e,t,o){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(i.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)i.d(o,n,function(t){return e[t]}.bind(null,n));return o},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/music-player/";var l=window["webpackJsonp"]=window["webpackJsonp"]||[],a=l.push.bind(l);l.push=t,l=l.slice();for(var c=0;c<l.length;c++)t(l[c]);var u=a;s.push([0,"chunk-vendors"]),o()})({0:function(e,t,o){e.exports=o("56d7")},1543:function(e,t,o){"use strict";o.r(t),o.d(t,"db",(function(){return s})),o.d(t,"auth",(function(){return l})),o.d(t,"fieldValue",(function(){return i})),o.d(t,"currentUser",(function(){return a})),o.d(t,"usersCollection",(function(){return c})),o.d(t,"songsCollection",(function(){return u})),o.d(t,"playlistsCollection",(function(){return d}));var n=o("59ca"),r=(o("e71f"),{apiKey:"AIzaSyCUm0WqIVDntNDzM-va26PLge3A-x62C2A",authDomain:"music-player-78833.firebaseapp.com",databaseURL:"https://music-player-78833.firebaseio.com",projectId:"music-player-78833",storageBucket:"music-player-78833.appspot.com",messagingSenderId:"515956915446",appId:"1:515956915446:web:0e45bd66b6e32d78e2c0d7"});n["initializeApp"](r);var s=n["firestore"](),i=n["firestore"].FieldValue,l=n["auth"](),a=l.currentUser,c=s.collection("users"),u=s.collection("songs"),d=s.collection("playlists")},"55e3":function(e,t,o){},"56d7":function(e,t,o){"use strict";o.r(t);o("e260"),o("e6cf"),o("cca6"),o("a79d");var n=o("2b0e"),r=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{attrs:{id:"app"}},[o("router-view")],1)},s=[],i={},l=i,a=o("2877"),c=Object(a["a"])(l,r,s,!1,null,null,null),u=c.exports,d=(o("45fc"),o("8c4f")),p=o("8aa5"),m=o.n(p),g=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("NavBar"),o("router-view"),o("Player")],1)},f=[],h=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("el-menu",{attrs:{id:"navBar","default-active":e.activeLink,mode:"horizontal",router:!0}},[o("el-menu-item",{staticStyle:{"flex-grow":"2"},attrs:{index:"/songs"}},[e._v("Songs")]),o("el-menu-item",{staticStyle:{"flex-grow":"2"},attrs:{index:"/playlists"}},[e._v("Playlists")]),o("div",{staticStyle:{"flex-grow":"1"}},[o("div",{staticClass:"profile-container"},[o("p",{staticClass:"profile"},[e._v(e._s(this.userProfile.name))]),o("el-tooltip",{staticClass:"item",attrs:{content:"Log out",placement:"bottom-end"}},[o("el-popconfirm",{attrs:{confirmButtonText:"Log out",cancelButtonText:"Cancel",icon:"el-icon-info",iconColor:"red",title:"Are you sure you want to log out?"},on:{onConfirm:e.logout}},[o("a",{staticClass:"profile",staticStyle:{float:"right"},attrs:{slot:"reference"},slot:"reference"},[o("i",{staticClass:"el-icon-switch-button"})])])],1)],1)])],1)},b=[],y=o("5530"),v=o("2f62"),w=o("1543"),P={name:"NavBar",data:function(){return{activeLink:"/songs"}},computed:Object(y["a"])({},Object(v["b"])(["userProfile"])),methods:{logout:function(){var e=this;w.auth.signOut().then((function(){e.$store.dispatch("clearData"),e.$router.push("/login")}))["catch"]((function(e){console.log(e)}))},goTo:function(e){this.$route.path!==e&&this.$router.push(e)}},mounted:function(){this.activeLink=this.$route.path},watch:{$route:function(e){this.activeLink=e.path}}},S=P,_=Object(a["a"])(S,h,b,!1,null,null,null),C=_.exports,F=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("transition",{attrs:{name:"fade",mode:"out-in"}},[e.currentSong?o("el-card",{staticClass:"box-card",attrs:{id:"player"}},[o("p",[e._v(e._s(this.currentSong.title)+" - "+e._s(this.currentSong.artist))]),o("audio",{ref:"player",attrs:{src:this.currentSong.url},on:{loadedmetadata:e.onLoadedMetadata}}),o("div",{staticClass:"player-container"},[o("el-button",{staticClass:"play-button",class:{"el-icon-video-play":!e.isPlaying,"el-icon-video-pause":e.isPlaying},attrs:{loading:e.loading,circle:""},on:{click:e.togglePlay}}),o("p",[e._v(e._s(e.currentTime))]),o("input",{directives:[{name:"model",rawName:"v-model",value:e.progressBarValue,expression:"progressBarValue"}],staticClass:"slider",attrs:{type:"range"},domProps:{value:e.progressBarValue},on:{change:e.handleTouchProgressBar,__r:function(t){e.progressBarValue=t.target.value}}}),o("p",[e._v(e._s(e.totalTime))]),o("i",{staticClass:"el-icon-headset music-icon large-icon"}),o("input",{directives:[{name:"model",rawName:"v-model",value:e.volume,expression:"volume"}],attrs:{type:"range"},domProps:{value:e.volume},on:{change:e.handleTouchVolume,__r:function(t){e.volume=t.target.value}}})],1)]):e._e()],1)},$=[],k=(o("0d03"),o("d3b7"),o("25f0"),o("4795"),{name:"Player",data:function(){return{progressBarValue:0,currentTime:"0:00",totalTime:"",isPlaying:!1,timer:"",loading:!0,volume:0}},computed:Object(y["a"])({},Object(v["b"])(["currentSong"])),methods:{togglePlay:function(){this.isPlaying?this.pause():this.play()},play:function(){this.$refs.player.play(),this.isPlaying=!0},pause:function(){this.$refs.player.pause(),this.isPlaying=!1},volumeUp:function(){this.$refs.player.volume+=this.$refs.player.volume<1?.1:0},volumeDown:function(){this.$refs.player.volume-=this.$refs.player.volume>0?.1:0},toMin:function(e){var t=Math.round(e),o="0:00"+t,n=(t%60).toString();if(+n<10&&(n="0"+n),e>59){var r=Math.floor(t/60).toString();+r<10&&(r="0"+r),o=r+":"+n}else o="0:"+n;return o},onLoadedMetadata:function(){this.loading=!1,this.play(),this.totalTime=this.toMin(this.$refs.player.duration),this.updateValue(),this.volume=100*this.$refs.player.volume},updateValue:function(){var e=this;this.progressBarValue=this.$refs.player.currentTime/this.$refs.player.duration*100,this.currentTime=this.toMin(this.$refs.player.currentTime),this.timer=setInterval((function(){e.$refs.player&&(e.progressBarValue=e.$refs.player.currentTime/e.$refs.player.duration*100,e.currentTime=e.toMin(e.$refs.player.currentTime))}),1e3)},handleTouchProgressBar:function(e){this.progressBarValue=e.target.value;var t=this.$refs.player.duration*(e.target.value/100);this.$refs.player.currentTime=t},handleTouchVolume:function(e){this.volume=e.target.value,this.$refs.player.volume=e.target.value/100},beforeDestroy:function(){clearInterval(this.timer)}},watch:{currentSong:{deep:!0,handler:function(){this.progressBarValue=0,this.currentTime="0:00",this.totalTime="",this.isPlaying=!1,this.loading=!0}}}}),x=k,O=Object(a["a"])(x,F,$,!1,null,null,null),V=O.exports,E={name:"Home",components:{NavBar:C,Player:V}},T=E,D=Object(a["a"])(T,g,f,!1,null,null,null),j=D.exports,A=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("section",{attrs:{id:"login"}},[o("el-card",{staticClass:"box-card col2",class:{"signup-form":!e.showLoginForm}},[e.showLoginForm?o("el-form",{ref:"loginForm",attrs:{model:e.loginForm,rules:e.rulesLogin,id:"form","validate-on-rule-change":!1,"hide-required-asterisk":!0},on:{submit:function(e){e.preventDefault()}}},[o("h1",[e._v("Login")]),o("el-form-item",{attrs:{label:"Email",prop:"email"}},[o("el-input",{attrs:{"prefix-icon":"el-icon-user",autocomplete:"off",placeholder:"you@email.com",type:"email"},model:{value:e.loginForm.email,callback:function(t){e.$set(e.loginForm,"email","string"===typeof t?t.trim():t)},expression:"loginForm.email"}})],1),o("el-form-item",{attrs:{label:"Password",prop:"password"}},[o("el-input",{attrs:{type:"password",placeholder:"******","prefix-icon":"el-icon-lock","show-password":""},model:{value:e.loginForm.password,callback:function(t){e.$set(e.loginForm,"password","string"===typeof t?t.trim():t)},expression:"loginForm.password"}})],1),o("div",{staticClass:"bottom-options"},[o("el-button",{attrs:{type:"text"},on:{click:e.toggleForm}},[e._v("Create an Account")]),o("el-button",{attrs:{type:"primary",round:"",loading:e.performingRequest},on:{click:e.login}},[e._v("Log In")])],1)],1):e._e(),e.showLoginForm?e._e():o("el-form",{ref:"signupForm",attrs:{model:e.signupForm,rules:e.rulesSignup,"validate-on-rule-change":!1,"hide-required-asterisk":!0},on:{submit:function(e){e.preventDefault()}}},[o("h1",[e._v("Create account")]),o("el-form-item",{attrs:{label:"Name",prop:"name"}},[o("el-input",{attrs:{type:"text",placeholder:"Jon Doe",id:"name"},model:{value:e.signupForm.name,callback:function(t){e.$set(e.signupForm,"name",t)},expression:"signupForm.name"}})],1),o("el-form-item",{attrs:{label:"Email",prop:"email"}},[o("el-input",{attrs:{"prefix-icon":"el-icon-user",autocomplete:"off",placeholder:"you@email.com",type:"email"},model:{value:e.signupForm.email,callback:function(t){e.$set(e.signupForm,"email","string"===typeof t?t.trim():t)},expression:"signupForm.email"}})],1),o("el-form-item",{attrs:{label:"Password",prop:"password"}},[o("el-input",{attrs:{type:"password",placeholder:"min 6 characters","prefix-icon":"el-icon-lock","show-password":""},model:{value:e.signupForm.password,callback:function(t){e.$set(e.signupForm,"password","string"===typeof t?t.trim():t)},expression:"signupForm.password"}})],1),o("el-form-item",{attrs:{label:"Confirm password",prop:"checkPass"}},[o("el-input",{attrs:{type:"password",placeholder:"min 6 characters","prefix-icon":"el-icon-lock","show-password":""},model:{value:e.signupForm.checkPass,callback:function(t){e.$set(e.signupForm,"checkPass","string"===typeof t?t.trim():t)},expression:"signupForm.checkPass"}})],1),o("div",{staticClass:"bottom-options"},[o("el-button",{attrs:{type:"text"},on:{click:e.toggleForm}},[e._v("Back to Log In")]),o("el-button",{attrs:{type:"primary",round:"",loading:e.performingRequest},on:{click:e.signup}},[e._v("Sign Up")])],1)],1),o("transition",{attrs:{name:"fade"}},[""!==e.errorMsg?o("div",{staticClass:"error-msg"},[o("p",[e._v(e._s(e.errorMsg))])]):e._e()])],1)],1)},L=[],U=(o("b0c0"),o("b64b"),o("96cf"),o("1da1")),R=o("1543"),q={name:"Login",data:function(){var e=this,t=function(e,t,o){if(!t)return o(new Error("Please input the password"));setTimeout((function(){t.length<7?o(new Error("Password size must be greater than 6")):o()}),1e3)},o=function(t,o,n){""===o?n(new Error("Please input the password")):(""!==e.signupForm.checkPass&&e.$refs.signupForm.validateField("checkPass"),n())},n=function(t,o,n){""===o?n(new Error("Please input the password again")):o!==e.signupForm.password?n(new Error("The passwords don't match!")):n()};return{loginForm:{email:"",password:""},signupForm:{name:"",email:"",password:"",checkPass:""},rulesLogin:{email:[{required:!0,message:"Please input an email",trigger:"blur"}],password:[{validator:o,trigger:"blur"}]},rulesSignup:{name:[{required:!0,message:"Please input a name",trigger:"blur"}],email:[{required:!0,message:"Please input an email",trigger:"blur"}],password:[{validator:o,trigger:"blur"},{validator:t,trigger:"blur"}],checkPass:[{validator:n,trigger:"blur"}]},showLoginForm:!0,passwordResetSuccess:!1,performingRequest:!1,errorMsg:""}},methods:{toggleForm:function(){this.errorMsg="",this.resetForm(),this.showLoginForm=!this.showLoginForm},resetForm:function(){this.showLoginForm?this.$refs["loginForm"].clearValidate(Object.keys(this.loginForm)):this.$refs["signupForm"].clearValidate(Object.keys(this.signupForm)),this.showLoginForm?this.$refs["loginForm"].resetFields():this.$refs["signupForm"].resetFields(),this.loginForm={email:"",password:""},this.signupForm={email:"",password:"",name:"",checkPass:""}},login:function(){var e=this;this.$refs["loginForm"].validate((function(t){t&&(e.performingRequest=!0,R.auth.signInWithEmailAndPassword(e.loginForm.email,e.loginForm.password).then((function(t){e.$store.commit("setCurrentUser",t.user),e.$store.dispatch("fetchUserProfile"),e.performingRequest=!1,e.$router.push("/songs")}))["catch"]((function(t){console.log(t),e.performingRequest=!1,e.errorMsg=t.message})))}))},signup:function(){var e=this;return Object(U["a"])(regeneratorRuntime.mark((function t(){var o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.performingRequest=!0,t.next=3,R.auth.createUserWithEmailAndPassword(e.signupForm.email,e.signupForm.password);case 3:o=t.sent,e.$store.commit("setCurrentUser",o.user),R.usersCollection.doc(o.user.uid).set({name:e.signupForm.name,email:e.signupForm.email}).then((function(){e.$store.dispatch("fetchUserProfile"),e.performingRequest=!1,e.$router.push("/songs")}))["catch"]((function(t){console.log(t),e.performingRequest=!1,e.errorMsg=t.message}));case 6:case"end":return t.stop()}}),t)})))()},resetPassword:function(){var e=this;this.performingRequest=!0,R.auth.sendPasswordResetEmail(this.passwordForm.email).then((function(){e.performingRequest=!1,e.passwordResetSuccess=!0,e.passwordForm.email=""}))["catch"]((function(t){console.log(t),e.performingRequest=!1,e.errorMsg=t.message}))}}},B=q,N=Object(a["a"])(B,A,L,!1,null,null,null),M=N.exports,I=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"main-container",attrs:{id:"songs"}},[o("div",{staticClass:"top-row"},[o("h1",[e._v("Your songs")]),o("el-button",{attrs:{type:"primary",round:""},on:{click:function(t){e.dialogFormVisible=!0}}},[e._v("Add Song")])],1),o("el-input",{attrs:{placeholder:"Search by title"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}}),o("el-table",{staticClass:"songs-table",attrs:{data:e.songs.filter((function(t){return!e.search||t.title.toLowerCase().includes(e.search.toLowerCase())})),"empty-text":"No songs"}},[o("el-table-column",{attrs:{width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-button",{attrs:{type:"text",icon:"el-icon-video-play"},on:{click:function(o){return e.playSong(e.songs[t.$index])}}})]}}])}),o("el-table-column",{attrs:{prop:"title",label:"Title"}}),o("el-table-column",{attrs:{prop:"artist",label:"Artist"}}),o("el-table-column",{attrs:{prop:"album",label:"Album"}}),o("el-table-column",{attrs:{align:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("div",{staticClass:"actions"},[o("el-tooltip",{staticClass:"item",attrs:{content:"Edit song",placement:"bottom-end"}},[o("el-button",{attrs:{icon:"el-icon-edit",circle:""},on:{click:function(o){return e.handleEditSong(e.songs[t.$index])}}})],1),o("el-tooltip",{staticClass:"item",attrs:{content:"Add to playlist",placement:"bottom-end"}},[o("el-button",{attrs:{icon:"el-icon-plus",circle:""},on:{click:function(o){return e.handleAddToPlaylist(e.songs[t.$index])}}})],1),o("el-tooltip",{staticClass:"item",attrs:{content:"Delete song",placement:"bottom-end"}},[o("el-button",{attrs:{type:"danger",icon:"el-icon-delete",circle:""},on:{click:function(o){return e.handleDeleteSong(e.songs[t.$index])}}})],1)],1)]}}])}),o("el-table-column",{attrs:{width:"50"}})],1),o("el-dialog",{attrs:{title:e.isEditForm?"Edit Song":"Add Song",visible:e.dialogFormVisible,width:"40%"},on:{"update:visible":function(t){e.dialogFormVisible=t},close:e.resetForm}},[o("el-form",{ref:"songForm",attrs:{model:e.song,rules:e.rules,id:"form","label-position":"top"}},[o("el-form-item",{staticStyle:{padding:"0"},attrs:{label:"Title","label-width":e.formLabelWidth,prop:"title"}},[o("el-input",{attrs:{autocomplete:"off",placeholder:"Daydreaming"},model:{value:e.song.title,callback:function(t){e.$set(e.song,"title",t)},expression:"song.title"}})],1),o("el-form-item",{attrs:{label:"Artist","label-width":e.formLabelWidth,prop:"artist"}},[o("el-input",{attrs:{autocomplete:"off",placeholder:"Radiohead"},model:{value:e.song.artist,callback:function(t){e.$set(e.song,"artist",t)},expression:"song.artist"}})],1),o("el-form-item",{attrs:{label:"Album","label-width":e.formLabelWidth,prop:"album"}},[o("el-input",{attrs:{autocomplete:"off",placeholder:"A moon shaped pool"},model:{value:e.song.album,callback:function(t){e.$set(e.song,"album",t)},expression:"song.album"}})],1),o("el-form-item",{attrs:{label:"Url","label-width":e.formLabelWidth,prop:"url"}},[o("el-input",{attrs:{autocomplete:"off",placeholder:"https://music.com/cello82.mp3"},model:{value:e.song.url,callback:function(t){e.$set(e.song,"url",t)},expression:"song.url"}})],1)],1),o("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{attrs:{round:""},on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("Cancel")]),o("el-button",{attrs:{type:"primary",loading:e.loading,round:""},on:{click:e.submitSong}},[e._v(e._s(e.isEditForm?"Edit Song":"Add Song"))])],1)],1),o("el-dialog",{attrs:{title:"Delete song",visible:e.deleteDialogVisible,width:"40%"},on:{"update:visible":function(t){e.deleteDialogVisible=t}}},[e.currentSong?o("span",[e._v(" Are you sure you want to delete "),o("i",[e._v(e._s(this.currentSong.title))]),e._v(" by "),o("i",[e._v(e._s(this.currentSong.artist))]),e._v("? ")]):e._e(),o("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{attrs:{round:""},on:{click:function(t){e.deleteDialogVisible=!1}}},[e._v("Cancel")]),o("el-button",{attrs:{type:"danger",loading:e.loading,round:""},on:{click:e.deleteSong}},[e._v("Delete")])],1)]),o("el-dialog",{attrs:{title:"Add to playlist",visible:e.addToPlaylistDialogVisible,width:"40%"},on:{"update:visible":function(t){e.addToPlaylistDialogVisible=t}}},[o("p",[e._v("Add this song to a new playlist")]),o("el-input",{attrs:{autocomplete:"off",placeholder:"New playlist name"},model:{value:e.newPlaylistName,callback:function(t){e.newPlaylistName=t},expression:"newPlaylistName"}}),e.playlists.length>0?o("div",{staticClass:"playlist-list"},[o("p",[e._v("Or select one of your playlists")]),o("el-table",{staticStyle:{"margin-top":"0"},attrs:{data:e.playlists,"show-header":!1,"empty-text":"There are no playlists"},on:{"selection-change":e.handlePlaylistsSelection}},[o("el-table-column",{attrs:{type:"selection",width:"55"}}),o("el-table-column",{attrs:{property:"name"}})],1)],1):e._e(),e.showAddPlaylistError?o("div",{staticClass:"error-msg"},[o("p",[e._v("You must select or create a playlist")])]):e._e(),o("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{attrs:{round:""},on:{click:function(t){e.addToPlaylistDialogVisible=!1}}},[e._v("Cancel")]),o("el-button",{attrs:{type:"primary",loading:e.loading,round:""},on:{click:e.addSongToPlaylist}},[e._v("Add to playlist")])],1)],1)],1)},W=[],z=(o("4160"),o("ac1f"),o("466d"),o("159b"),o("1543")),J=function(e,t,o){var n=/^(https?|ftp|file):\/\/(www.)?(.*?)\.(mp3)$/;""===t?o(new Error("Please input an url")):null===t.match(n)?o(new Error("Please input a valid mp3 url")):o()},Y={data:function(){return{closeOnClick:!1,dialogFormVisible:!1,deleteDialogVisible:!1,addToPlaylistDialogVisible:!1,showAddPlaylistError:!1,song:{title:"",artist:"",album:"",url:""},newPlaylistName:"",rules:{title:[{required:!0,message:"Please input a title",trigger:"blur"}],album:[{required:!0,message:"Please input an album",trigger:"blur"}],artist:[{required:!0,message:"Please input an artist",trigger:"blur"}],url:[{required:!0,validator:J,trigger:"blur"}]},formLabelWidth:"120px",loading:!1,isEditForm:!1,currentSong:null,play:!1,search:"",selectedPlaylists:[]}},computed:Object(y["a"])({},Object(v["b"])(["userProfile","currentUser","songs","playlists"])),methods:{updateSong:function(){var e=this;this.loading=!0,z.songsCollection.doc(this.song.id).set(Object(y["a"])({},this.song),{merge:!0}).then((function(){e.song={},e.resetForm(),e.dialogFormVisible=!1,e.loading=!1}))["catch"]((function(t){console.log(t),e.loading=!1}))},createSong:function(){var e=this;this.loading=!0,z.songsCollection.add(Object(y["a"])(Object(y["a"])({},this.song),{},{createdOn:new Date,userId:this.currentUser.uid})).then((function(){e.song={},e.resetForm(),e.dialogFormVisible=!1,e.loading=!1,e.$message("New song added")}))["catch"]((function(t){console.log(t),e.loading=!1}))},deleteSong:function(){var e=this;this.loading=!0,z.songsCollection.doc(this.currentSong.id)["delete"]().then((function(){e.deleteDialogVisible=!1,e.loading=!1,e.$message("Song deleted succesfully")}))["catch"]((function(e){console.error("Error removing document: ",e),this.loading=!1}))},submitSong:function(){var e=this;this.$refs["songForm"].validate((function(t){if(!t)return console.log("error submit!!"),!1;e.isEditForm?e.updateSong():e.createSong()}))},resetForm:function(){this.$refs["songForm"].resetFields(),this.song={title:"",artist:"",album:""}},handleEditSong:function(e){this.song=Object(y["a"])({},e),this.isEditForm=!0,this.dialogFormVisible=!0},handleDeleteSong:function(e){this.deleteDialogVisible=!0,this.currentSong=e},handleAddToPlaylist:function(e){this.addToPlaylistDialogVisible=!0,this.currentSong=e},handleCurrentChange:function(e){this.currentSong=Object(y["a"])({},e)},playSong:function(e){this.currentSong=e,this.$store.commit("setCurrentSong",this.currentSong)},handlePlaylistsSelection:function(e){this.selectedPlaylists=e},addSongToPlaylist:function(){var e=this;return Object(U["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.loading=!0,""===e.newPlaylistName){t.next=9;break}return e.showAddPlaylistError=!1,t.next=5,z.playlistsCollection.add({name:e.newPlaylistName,createdOn:new Date,userId:e.currentUser.uid,songs:[e.currentSong.id]});case 5:e.addToPlaylistDialogVisible=!1,e.$message("Song added to playlist successfully"),t.next=10;break;case 9:e.selectedPlaylists.length>0?(e.showAddPlaylistError=!1,e.selectedPlaylists.forEach(function(){var t=Object(U["a"])(regeneratorRuntime.mark((function t(o){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,z.playlistsCollection.doc(o.id).update({songs:z.fieldValue.arrayUnion(e.currentSong.id)});case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),e.addToPlaylistDialogVisible=!1,e.$message("Song added to playlist successfully")):e.showAddPlaylistError=!0;case 10:e.loading=!1;case 11:case"end":return t.stop()}}),t)})))()}}},H=Y,K=Object(a["a"])(H,I,W,!1,null,null,null),G=K.exports,Q=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"main-container",attrs:{id:"playlists"}},[o("h1",[e._v("Your playlists")]),e.playlists?o("div",[o("el-input",{attrs:{placeholder:"Search by name"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}}),o("el-table",{ref:"playlistsTable",staticClass:"songs-table",attrs:{data:e.playlists.filter((function(t){return!e.search||t.name.toLowerCase().includes(e.search.toLowerCase())})),"highlight-current-row":"","empty-text":"No playlists, add a song to a new playlist to create one"},on:{"current-change":e.handleCurrentChange}},[o("el-table-column",{attrs:{prop:"name",label:"Name"}}),o("el-table-column",{attrs:{width:"100"}},[o("el-button",{attrs:{icon:"el-icon-arrow-right",round:""}})],1)],1)],1):e._e()])},X=[],Z={data:function(){return{search:""}},computed:Object(y["a"])({},Object(v["b"])(["playlists"])),methods:{handleCurrentChange:function(e){this.$store.commit("setCurrentPlaylist",e),this.$router.push({name:"playlistDetails",params:{id:e.id}})}}},ee=Z,te=Object(a["a"])(ee,Q,X,!1,null,null,null),oe=te.exports,ne=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"main-container",attrs:{id:"playlist-detail"}},[e.currentPlaylist?o("el-page-header",{attrs:{title:"Back to playlists",content:e.currentPlaylist.name},on:{back:e.goBack}}):e._e(),e.songs?o("div",[o("el-table",{attrs:{data:e.songs.filter((function(t){return!e.search||t.name.toLowerCase().includes(e.search.toLowerCase())})),"empty-text":"No songs"}},[o("el-table-column",{attrs:{width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-button",{attrs:{type:"text",icon:"el-icon-video-play"},on:{click:function(o){return e.playSong(e.songs[t.$index])}}})]}}],null,!1,1870224885)}),o("el-table-column",{attrs:{prop:"title",label:"Title"}}),o("el-table-column",{attrs:{prop:"artist",label:"Artist"}}),o("el-table-column",{attrs:{prop:"album",label:"Album"}}),o("el-table-column",{attrs:{width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-tooltip",{staticClass:"item",attrs:{content:"Remove from playlist",placement:"bottom-end"}},[o("el-button",{attrs:{type:"danger",icon:"el-icon-delete",circle:""},on:{click:function(o){return e.handleDeleteSong(e.songs[t.$index])}}})],1)]}}],null,!1,1011059502)})],1)],1):e._e(),o("el-dialog",{attrs:{title:"Remove song",visible:e.deleteDialogVisible,width:"40%"},on:{"update:visible":function(t){e.deleteDialogVisible=t}}},[e.currentSong?o("span",[e._v(" Are you sure you want to remove "),o("i",[e._v(e._s(this.currentSong.title))]),e._v(" by "),o("i",[e._v(e._s(this.currentSong.artist)+" ")]),e._v("from this playlist ? ")]):e._e(),o("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{attrs:{round:""},on:{click:function(t){e.deleteDialogVisible=!1}}},[e._v("Cancel")]),o("el-button",{attrs:{type:"danger",loading:e.loading,round:""},on:{click:e.deleteSong}},[e._v("Remove")])],1)])],1)},re=[],se=(o("c975"),o("a434"),o("1543")),ie={data:function(){return{search:"",songs:[],deleteDialogVisible:!1,currentSong:null,loading:!1}},created:function(){this.currentPlaylist?this.fetchSongs():this.fetchPlaylistAndSongs()},computed:Object(y["a"])({},Object(v["b"])(["userProfile","currentUser","currentPlaylist"])),methods:{goBack:function(){this.$router.push({name:"playlists"})},playSong:function(e){this.currentSong=e,this.$store.commit("setCurrentSong",this.currentSong)},handleDeleteSong:function(e){this.deleteDialogVisible=!0,this.currentSong=e},deleteSong:function(){var e=this;this.loading=!0,console.log(this.currentSong,this.currentPlaylist.id),se.playlistsCollection.doc(this.currentPlaylist.id).update({songs:se.fieldValue.arrayRemove(this.currentSong.id)}).then((function(){e.deleteDialogVisible=!1,e.loading=!1;var t=e.songs.indexOf(e.currentSong);t>-1&&e.songs.splice(t,1)}))["catch"]((function(t){console.log(t),e.loading=!1}))},fetchSongs:function(){var e=this;this.currentPlaylist.songs.forEach((function(t){se.songsCollection.doc(t).get().then((function(t){if(t.exists){var o=t.data();o.id=t.id,e.songs.push(o)}else console.log("No such document!")}))["catch"]((function(e){console.log("Error getting document:",e)}))}))},fetchPlaylistAndSongs:function(){var e=this;se.playlistsCollection.doc(this.$route.params.id).get().then((function(t){if(t.exists){var o=t.data();o.id=t.id,e.$store.commit("setCurrentPlaylist",t.data()),e.fetchSongs()}else console.log("No such document!")}))["catch"]((function(e){console.log("Error getting document:",e)}))}}},le=ie,ae=Object(a["a"])(le,ne,re,!1,null,null,null),ce=ae.exports;n["default"].use(d["a"]);var ue=[{path:"*",redirect:"/"},{path:"/",name:"Home",component:j,children:[{path:"songs",component:G},{path:"playlists",name:"playlists",component:oe},{path:"playlists/:id",name:"playlistDetails",component:ce}],meta:{requiresAuth:!0}},{path:"/login",name:"Login",component:M}],de=new d["a"]({mode:"history",base:"/music-player/",routes:ue});de.beforeEach((function(e,t,o){var n=e.matched.some((function(e){return e.meta.requiresAuth})),r=m.a.auth().currentUser;n&&!r?o("/login"):o()}));var pe=de,me=o("1543");n["default"].use(v["a"]),me.auth.onAuthStateChanged((function(e){e&&(fe.commit("setCurrentUser",e),fe.dispatch("fetchUserProfile"),me.usersCollection.doc(e.uid).onSnapshot((function(e){fe.commit("setUserProfile",e.data())})),me.songsCollection.where("userId","==",e.uid).orderBy("createdOn","desc").onSnapshot((function(e){var t=[];e.forEach((function(e){var o=e.data();o.id=e.id,t.push(o)})),fe.commit("setSongs",t)})),me.playlistsCollection.where("userId","==",e.uid).orderBy("createdOn","desc").onSnapshot((function(e){var t=[];e.forEach((function(e){var o=e.data();o.id=e.id,t.push(o)})),fe.commit("setPlaylists",t)}),(function(e){return console.error("there was an error",e)})))}));var ge,fe=new v["a"].Store({state:{currentUser:null,currentSong:null,currentPlaylist:null,userProfile:{},songs:[],playlists:[]},actions:{clearData:function(e){var t=e.commit;t("setCurrentUser",null),t("setUserProfile",{}),t("setSongs",null),t("setPlaylists",null),t("setCurrentSong",null),t("setCurrentPlaylist",null)},fetchUserProfile:function(e){var t=e.commit,o=e.state;me.usersCollection.doc(o.currentUser.uid).get().then((function(e){t("setUserProfile",e.data())}))["catch"]((function(e){console.log(e)}))}},mutations:{setCurrentUser:function(e,t){e.currentUser=t},setUserProfile:function(e,t){e.userProfile=t},setSongs:function(e,t){e.songs=t||[]},setCurrentSong:function(e,t){e.currentSong=t},setCurrentPlaylist:function(e,t){e.currentPlaylist=t},setPlaylists:function(e,t){e.playlists=t||[]}}}),he=(o("a89b"),o("5c96")),be=o.n(he),ye=(o("55e3"),o("1543"));n["default"].config.productionTip=!1,n["default"].use(be.a),ye.auth.onAuthStateChanged((function(){ge||(ge=new n["default"]({router:pe,store:fe,render:function(e){return e(u)}}).$mount("#app"))}))},a89b:function(e,t,o){}});
//# sourceMappingURL=app.f2e0b5b3.js.map